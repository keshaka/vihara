(function(){function q(a,b,d,c,e,n,k,l,h,f){this.pause=!0;this.options=b;this.slide=d;this.img=c;this.slot=e;this.levels=n;this.widths=k;this.slider=a;this.fixEdges=l;this.edgeFix=h;f&&(b=document.createElement("style"),b.type="text/css",document.head.appendChild(b),this.blurstyle={sheet:b,css:"."+f+" rs-sbg, ."+f+" .slot {filter: blur({{blur}}px);}"},this.resizeBlur(),a.on("revolution.slide.afterdraw",this.blurSizer.bind(this)))}jQuery("rs-slide[data-revaddonpaintbrush]").each(function(){var a=jQuery(this),b=a.children("img"),d=b.attr("data-bg"),c="";d&&(d=d.split("c:"),1<d.length&&(c=d[1].split(";")[0]));d="p:center center;";c&&(d+="c:"+c+";");b.attr({"data-bg":d,"data-kenburns":"off"}).removeAttr("data-panzoom");a.attr("data-revaddonpaintbrushedges")&&a.attr("data-anim","ei:d;eo:d;s:1000;r:0;t:fade;sl:0;")});jQuery("rs-slide[data-revaddonpaintbrushfallback]").each(function(){var a=jQuery(this),b=a.children("img");a=a.attr("data-revaddonpaintbrushfallback");var d=b.attr("data-lazyload"),c=d?"data-lazyload":"src";d?b.data("lazyload",a):b.attr(c,a)});var h,u="ontouchend"in document;window.RevSliderPaintBrush=function(a,b){if(h=a){var d=h.fn.revolution&&h.fn.revolution[b[0].id]?h.fn.revolution[b[0].id]:!1;if(d)b.on("revolution.slide.onloaded",function(){var a="",e=d.responsiveLevels,n=d.gridwidth;Array.isArray(e)||(e=[e]);Array.isArray(n)||(n=[n]);b.find("rs-slide[data-revaddonpaintbrush]").each(function(){var d,c=new Image,f=h(this).addClass("revaddon-paintbrush").data("paintbrushloading",!0),k=f.attr("data-key"),r=f.find("rs-sbg-wrap"),g=JSON.parse(this.getAttribute("data-revaddonpaintbrush"));g=h.extend(!0,{blurAmount:10,fadetime:1E3,edgefix:10,fixedges:!1,style:"round",blur:!1,scaleblur:!1,responsive:!1,disappear:!1,carousel:!1},g);if(g.blur){var m="revaddonblurfilter_"+k;g.scaleBlur?d=m:a+="."+m+" rs-sbg, ."+m+" .slot {filter: blur("+g.blurAmount+"px);}";f.addClass(m)}if(g.fixedges&&g.edgefix){var t=1+.01*g.edgefix;var p=t.toFixed(2);p="scale("+p+", "+p+")";r.find("rs-sbg").css("transform",p);m="revaddonblurfilterfix_"+k;a+="."+m+" rs-sbg {transform: "+p+" !important}";f.addClass(m)}c.onload=function(){g.width=this.naturalWidth;g.height=this.naturalHeight;var a=new q(b,g,f,c,r[0],e,n,p,t,d);f.removeData("paintbrushloading").data("revaddonbrush",a);f.data("paintbrushcurrent")&&(a.pause=!1,f.removeData("paintbrushcurrent"),a.inited||a.init())};c.onerror=function(){console.log("PaintBrush Addon: background image could not be loaded")};c.src=g.image});if(a){var k=document.createElement("style");k.type="text/css";k.innerHTML=a;document.head.appendChild(k)}}).on("revolution.slide.onbeforeswap",function(a,b){b.currentslide.removeData("paintbrushcurrent");var d=b.currentslide.data("revaddonbrush");d&&d.canvas&&(d.canvas.className="revaddonpaintbrush swapping")}).on("revolution.slide.onafterswap",function(a,d){var c;b.find(".revaddon-paintbrush").each(function(){if(c=h(this).removeData("paintbrushcurrent").data("revaddonbrush"))c.pause=!0,c.reset(),c.canvas&&(c.canvas.className="revaddonpaintbrush")});var e=b.revcurrentslide()-1;var l=b.find("rs-slide").eq(e);l.length||(l=b.find("rs-slide").eq(0));(c=l.data("revaddonbrush"))?(c.pause=!1,c.ready=!0,c.inited||c.init()):(e=l.data("paintbrushloading"))&&l.data("paintbrushcurrent",!0)})}};q.prototype={init:function(){this.canvas=document.createElement("canvas");this.brush=document.createElement("canvas");this.canvas.className="revaddonpaintbrush";this.context=this.canvas.getContext("2d");this.ctx=this.brush.getContext("2d");this.slot.parentNode.insertBefore(this.canvas,this.slot.nextSibling);this.inited=!0;this.steps=[];this.options.carousel?setTimeout(this.start.bind(this),100):this.start()},start:function(){if(this.options.carousel)this.slide.on("mousemove touchmove",this.onMove.bind(this));else this.slider.on("mousemove touchmove",this.onMove.bind(this));this.slider.on("revolution.slide.afterdraw",this.sizer.bind(this));this.resize()},onMove:function(a){if(!this.pause){u&&(a=a.originalEvent,a.preventDefault(),a.touches&&(a=a.touches[0]));var b=this.canvas.getBoundingClientRect();this.steps.unshift({time:Date.now(),x:a.clientX-b.left,y:a.clientY-b.top});this.draw()}},updateSteps:function(){for(var a=Date.now(),b=0;b<this.steps.length;b++)a-this.steps[b].time>this.options.fade&&(this.steps.length=b)},paint:function(){for(var a=this.steps.length,b=Date.now(),d,c=1;c<a;c++)d=(b-this.steps[c].time)/this.options.fadetime,d=Math.max(1-d,0),this.ctx.lineCap=this.options.style,this.ctx.strokeStyle="rgba(0, 0, 0, "+d+")",this.ctx.shadowBlur=this.options.strength,this.ctx.shadowColor="#000000",this.ctx.lineWidth=this.options.size,this.ctx.beginPath(),this.ctx.moveTo(this.steps[c-1].x,this.steps[c-1].y),this.ctx.lineTo(this.steps[c].x,this.steps[c].y),this.ctx.stroke()},draw:function(){this.updateSteps();cancelAnimationFrame(this.frame);this.steps.length&&(this.frame=window.requestAnimationFrame(this.draw.bind(this)));this.context.clearRect(0,0,this.canvas.width,this.canvas.height);this.options.disappear&&this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);this.paint();this.context.drawImage(this.img,this.cx,this.cy,this.cw,this.ch,0,0,this.canvas.width,this.canvas.height);this.context.globalCompositeOperation="destination-in";this.context.drawImage(this.brush,0,0);this.context.globalCompositeOperation="source-over"},reset:function(){this.context&&(cancelAnimationFrame(this.frame),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height))},sizer:function(){this.options.carousel?(clearTimeout(this.timer),this.timer=setTimeout(this.resize.bind(this),250)):this.resize()},resize:function(a){a||this.reset();var b=this.slide.width(),d=this.slide.height();this.edgeFix&&(b*=this.edgeFix,d*=this.edgeFix);var c=Math.min(b/this.options.width,d/this.options.height);if(a)return c;a=this.options.width*c;c*=this.options.height;var e=1;a<b&&(e=b/a);1E-14>Math.abs(e-1)&&c<d&&(e=d/c);this.cw=this.options.width/(a*e/b);this.ch=this.options.height/(c*e/d);this.cx=.5*(this.options.width-this.cw);this.cy=.5*(this.options.height-this.ch);this.canvas.width=this.brush.width=b;this.canvas.height=this.brush.height=d;if(this.options.responsive){d=this.levels.length;for(c=a=0;c<d;c++)b<this.levels[c]&&(a=c);this.options.size=this.options.origsize*Math.min(b/this.widths[a],1)}},blurSizer:function(){this.options.carousel?(clearTimeout(this.blurTimer),this.blurTimer=setTimeout(this.resizeBlur.bind(this),250)):this.resizeBlur()},resizeBlur:function(){var a=this.blurstyle;a.sheet.innerHTML=a.css.replace("{{blur}}",Math.max(Math.round(this.options.blurAmount*this.resize(!0)),1))}}})()
;